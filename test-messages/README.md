# 🧪 Test Messages for agent-send.sh

このディレクトリには、`agent-send.sh` の新機能（`--file`, `--stdin`, `--announce`）をテストするためのサンプルメッセージが格納されています。

## 📁 ファイル構成

### 1. `long-multiline-test.txt`
- **目的**: 長文・複雑なマルチラインメッセージのテスト
- **内容**: 
  - 日本語・英語混在テキスト
  - 表、コードブロック、JSON
  - 絵文字、特殊記号
  - 技術ドキュメント形式
- **サイズ**: 約3KB
- **行数**: 100行以上

### 2. `symbols-test.txt`  
- **目的**: 特殊記号・Unicode文字の送信テスト
- **内容**:
  - 基本記号・日本語記号
  - 数学・科学記号
  - 絵文字（各カテゴリー）
  - 多言語文字（中文、한국어、العربية、हिन्दी）
  - プログラミング記号
- **サイズ**: 約2KB

### 3. `code-mixed-test.txt`
- **目的**: コードと日本語の混在テスト  
- **内容**:
  - シェルスクリプト、TypeScript、Python
  - HTML/CSS、SQL
  - 正規表現、エラーメッセージ
  - 混在コメント
- **サイズ**: 約4KB
- **行数**: 200行以上

### 4. `README.md` (このファイル)
- **目的**: テストファイルの説明・使用方法

## 🚀 使用方法

### 基本的なファイル送信テスト
```bash
# 長文マルチラインテスト
./agent-send.sh --file worker2 test-messages/long-multiline-test.txt

# 特殊記号テスト  
./agent-send.sh --file worker3 test-messages/symbols-test.txt

# コード混在テスト
./agent-send.sh --file boss1 test-messages/code-mixed-test.txt
```

### 送信前確認付きテスト
```bash
# アナウンス機能でプレビュー確認
./agent-send.sh --announce --file worker1 test-messages/long-multiline-test.txt
```

### 標準入力テスト
```bash
# ファイルからパイプで標準入力に送る
cat test-messages/symbols-test.txt | ./agent-send.sh --stdin worker2

# ヒアドキュメントで複数行入力
./agent-send.sh --stdin president << 'EOF'
複数行の
テストメッセージです。
日本語も含まれています。
EOF
```

## 🧪 テスト項目

### ✅ 機能テスト
- [ ] `--file` オプション: ファイルからメッセージ読み込み
- [ ] `--stdin` オプション: 標準入力からメッセージ読み込み  
- [ ] `--announce` オプション: 送信前のプレビュー表示
- [ ] エラーハンドリング: 存在しないファイル、空ファイル
- [ ] 長文メッセージ送信 (3KB+)
- [ ] マルチライン改行保持

### ✅ 文字エンコーディングテスト
- [ ] 日本語文字 (ひらがな、カタカナ、漢字)
- [ ] 英語・数字・基本記号
- [ ] 特殊記号・Unicode文字
- [ ] 絵文字 (Emoji)
- [ ] 多言語文字 (中文、한국어、العربية等)
- [ ] プログラミング記号・エスケープ文字

### ✅ パフォーマンステスト
- [ ] 大容量ファイル送信 (5KB+)
- [ ] 高頻度送信テスト
- [ ] 同時並行送信テスト
- [ ] メモリ使用量確認

### ✅ インテグレーションテスト  
- [ ] tmux pane への正常送信
- [ ] Claude Code での受信確認
- [ ] ログファイル記録確認
- [ ] エラー時の適切な処理

## 📊 期待される結果

### 成功基準
1. **文字化けなし**: 全ての文字が正しく送信・表示される
2. **改行保持**: マルチラインメッセージの改行が保持される
3. **完全送信**: ファイル内容が切り捨てられることなく完全に送信される
4. **エラー処理**: 不正な入力に対して適切なエラーメッセージが表示される
5. **ログ記録**: 送信履歴がログファイルに正しく記録される

### 性能基準
- **送信時間**: 5KB以下のファイルは5秒以内に送信完了
- **メモリ使用**: 送信中のメモリ増加は最小限
- **安定性**: 100回連続送信でもエラーが発生しない

## 🔧 トラブルシューティング

### よくある問題
1. **文字化け**: ターミナルのエンコーディング設定を確認
2. **送信失敗**: tmux セッションの存在・状態を確認
3. **改行異常**: ファイルの改行コード (LF/CRLF) を確認
4. **権限エラー**: ファイルの読み取り権限を確認

### デバッグ方法
```bash
# 詳細ログ確認
tail -f logs/send_log.txt

# tmux セッション状態確認
tmux list-sessions
tmux list-panes -a

# ファイル内容確認 
file test-messages/*.txt
wc -l test-messages/*.txt
```

---

📝 **作成者**: worker1 (AI Agent)  
🗓️ **更新日**: 2025-08-13  
🎯 **目的**: agent-send.sh 機能拡張の品質保証